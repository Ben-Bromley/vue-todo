import{o as Te,c as Ne,p as mr,f as gr,a as _e,t as _r,n as br,r as kn,l as wr,b as xr,m as Er,q as kr,v as Ar,s as Cr,u as St,F as Sr,e as Kr,h as Tr,x as Dr}from"./vendor.098df5e6.js";import{_ as un}from"./index.f7e29782.js";/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var I=function(){return I=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},I.apply(this,arguments)};function Ot(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return t.concat(a||Array.prototype.slice.call(e))}var M=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:global,z=Object.keys,V=Array.isArray;typeof Promise!="undefined"&&!M.Promise&&(M.Promise=Promise);function U(t,e){return typeof e!="object"||z(e).forEach(function(n){t[n]=e[n]}),t}var He=Object.getPrototypeOf,Ir={}.hasOwnProperty;function Q(t,e){return Ir.call(t,e)}function Ie(t,e){typeof e=="function"&&(e=e(He(t))),(typeof Reflect=="undefined"?z:Reflect.ownKeys)(e).forEach(function(n){oe(t,n,e[n])})}var Nn=Object.defineProperty;function oe(t,e,n,r){Nn(t,e,U(n&&Q(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function Pe(t){return{from:function(e){return t.prototype=Object.create(e.prototype),oe(t.prototype,"constructor",t),{extend:Ie.bind(null,t.prototype)}}}}var Pr=Object.getOwnPropertyDescriptor;function on(t,e){var n=Pr(t,e),r;return n||(r=He(t))&&on(r,e)}var Rr=[].slice;function Et(t,e,n){return Rr.call(t,e,n)}function jn(t,e){return e(t)}function Fe(t){if(!t)throw new Error("Assertion Failed")}function Ln(t){M.setImmediate?setImmediate(t):setTimeout(t,0)}function Vn(t,e){return t.reduce(function(n,r,i){var a=e(r,i);return a&&(n[a[0]]=a[1]),n},{})}function Br(t,e,n){try{t.apply(null,n)}catch(r){e&&e(r)}}function ue(t,e){if(Q(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],r=0,i=e.length;r<i;++r){var a=ue(t,e[r]);n.push(a)}return n}var u=e.indexOf(".");if(u!==-1){var o=t[e.substr(0,u)];return o===void 0?void 0:ue(o,e.substr(u+1))}}function q(t,e,n){if(!(!t||e===void 0)&&!("isFrozen"in Object&&Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){Fe(typeof n!="string"&&"length"in n);for(var r=0,i=e.length;r<i;++r)q(t,e[r],n[r])}else{var a=e.indexOf(".");if(a!==-1){var u=e.substr(0,a),o=e.substr(a+1);if(o==="")n===void 0?V(t)&&!isNaN(parseInt(u))?t.splice(u,1):delete t[u]:t[u]=n;else{var s=t[u];s||(s=t[u]={}),q(s,o,n)}}else n===void 0?V(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function Or(t,e){typeof e=="string"?q(t,e,void 0):"length"in e&&[].map.call(e,function(n){q(t,n,void 0)})}function Hn(t){var e={};for(var n in t)Q(t,n)&&(e[n]=t[n]);return e}var Mr=[].concat;function Un(t){return Mr.apply([],t)}var Wn="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Un([8,16,32,64].map(function(t){return["Int","Uint","Float"].map(function(e){return e+t+"Array"})}))).filter(function(t){return M[t]}),Fr=Wn.map(function(t){return M[t]});Vn(Wn,function(t){return[t,!0]});var he=null;function Ge(t){he=typeof WeakMap!="undefined"&&new WeakMap;var e=Mt(t);return he=null,e}function Mt(t){if(!t||typeof t!="object")return t;var e=he&&he.get(t);if(e)return e;if(V(t)){e=[],he&&he.set(t,e);for(var n=0,r=t.length;n<r;++n)e.push(Mt(t[n]))}else if(Fr.indexOf(t.constructor)>=0)e=t;else{var i=He(t);e=i===Object.prototype?{}:Object.create(i),he&&he.set(t,e);for(var a in t)Q(t,a)&&(e[a]=Mt(t[a]))}return e}var zr={}.toString;function Ft(t){return zr.call(t).slice(8,-1)}var zt=typeof Symbol!="undefined"?Symbol.iterator:"@@iterator",Nr=typeof zt=="symbol"?function(t){var e;return t!=null&&(e=t[zt])&&e.apply(t)}:function(){return null},Se={};function ie(t){var e,n,r,i;if(arguments.length===1){if(V(t))return t.slice();if(this===Se&&typeof t=="string")return[t];if(i=Nr(t)){for(n=[];r=i.next(),!r.done;)n.push(r.value);return n}if(t==null)return[t];if(e=t.length,typeof e=="number"){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}var sn=typeof Symbol!="undefined"?function(t){return t[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},te=typeof location!="undefined"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Yn(t,e){te=t,$n=e}var $n=function(){return!0},jr=!new Error("").stack;function ke(){if(jr)try{throw ke.arguments,new Error}catch(t){return t}return new Error}function Nt(t,e){var n=t.stack;return n?(e=e||0,n.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),n.split(`
`).slice(e).filter($n).map(function(r){return`
`+r}).join("")):""}var Lr=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],Qn=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],cn=Lr.concat(Qn),Vr={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Re(t,e){this._e=ke(),this.name=t,this.message=e}Pe(Re).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Nt(this._e,2))}},toString:function(){return this.name+": "+this.message}});function Xn(t,e){return t+". Errors: "+Object.keys(e).map(function(n){return e[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join(`
`)}function vt(t,e,n,r){this._e=ke(),this.failures=e,this.failedKeys=r,this.successCount=n,this.message=Xn(t,e)}Pe(vt).from(Re);function je(t,e){this._e=ke(),this.name="BulkError",this.failures=Object.keys(e).map(function(n){return e[n]}),this.failuresByPos=e,this.message=Xn(t,e)}Pe(je).from(Re);var ln=cn.reduce(function(t,e){return t[e]=e+"Error",t},{}),Hr=Re,K=cn.reduce(function(t,e){var n=e+"Error";function r(i,a){this._e=ke(),this.name=n,i?typeof i=="string"?(this.message=""+i+(a?`
 `+a:""),this.inner=a||null):typeof i=="object"&&(this.message=i.name+" "+i.message,this.inner=i):(this.message=Vr[e]||n,this.inner=null)}return Pe(r).from(Hr),t[e]=r,t},{});K.Syntax=SyntaxError;K.Type=TypeError;K.Range=RangeError;var An=Qn.reduce(function(t,e){return t[e+"Error"]=K[e],t},{});function Ur(t,e){if(!t||t instanceof Re||t instanceof TypeError||t instanceof SyntaxError||!t.name||!An[t.name])return t;var n=new An[t.name](e||t.message,t);return"stack"in t&&oe(n,"stack",{get:function(){return this.inner.stack}}),n}var kt=cn.reduce(function(t,e){return["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=K[e]),t},{});kt.ModifyError=vt;kt.DexieError=Re;kt.BulkError=je;function O(){}function qe(t){return t}function Wr(t,e){return t==null||t===qe?e:function(n){return e(t(n))}}function xe(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function Yr(t,e){return t===O?e:function(){var n=t.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?xe(r,this.onsuccess):r),i&&(this.onerror=this.onerror?xe(i,this.onerror):i),a!==void 0?a:n}}function $r(t,e){return t===O?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?xe(n,this.onsuccess):n),r&&(this.onerror=this.onerror?xe(r,this.onerror):r)}}function Qr(t,e){return t===O?e:function(n){var r=t.apply(this,arguments);U(n,r);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var u=e.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?xe(i,this.onsuccess):i),a&&(this.onerror=this.onerror?xe(a,this.onerror):a),r===void 0?u===void 0?void 0:u:U(r,u)}}function Xr(t,e){return t===O?e:function(){return e.apply(this,arguments)===!1?!1:t.apply(this,arguments)}}function fn(t,e){return t===O?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,a=new Array(i);i--;)a[i]=arguments[i];return n.then(function(){return e.apply(r,a)})}return e.apply(this,arguments)}}var Ue={},Gr=100,qr=20,Gn=100,hn=typeof Promise=="undefined"?[]:function(){var t=Promise.resolve();if(typeof crypto=="undefined"||!crypto.subtle)return[t,He(t),t];var e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,He(e),t]}(),jt=hn[0],pt=hn[1],Lt=hn[2],qn=pt&&pt.then,st=jt&&jt.constructor,dn=!!Lt,Vt=!1,Jr=Lt?function(){Lt.then(rt)}:M.setImmediate?setImmediate.bind(null,rt):M.MutationObserver?function(){var t=document.createElement("div");new MutationObserver(function(){rt(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:function(){setTimeout(rt,0)},We=function(t,e){ze.push([t,e]),yt&&(Jr(),yt=!1)},Ht=!0,yt=!0,be=[],ct=[],Ut=null,Wt=qe,De={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Kn,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(t){try{Kn(t[0],t[1])}catch{}})}},A=De,ze=[],we=0,lt=[];function k(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=O,this._lib=!1;var e=this._PSD=A;if(te&&(this._stackHolder=ke(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==Ue)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&$t(this,this._value);return}this._state=null,this._value=null,++e.ref,Zn(this,t)}var Yt={get:function(){var t=A,e=mt;function n(r,i){var a=this,u=!t.global&&(t!==A||e!==mt),o=u&&!se(),s=new k(function(c,f){vn(a,new Jn(_t(r,t,u,o),_t(i,t,u,o),c,f,t))});return te&&nr(s,this),s}return n.prototype=Ue,n},set:function(t){oe(this,"then",t&&t.prototype===Ue?Yt:{get:function(){return t},set:Yt.set})}};Ie(k.prototype,{then:Yt,_then:function(t,e){vn(this,new Jn(null,null,t,e,A))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],n=arguments[1];return typeof e=="function"?this.then(null,function(r){return r instanceof e?n(r):ft(r)}):this.then(null,function(r){return r&&r.name===e?n(r):ft(r)})},finally:function(t){return this.then(function(e){return t(),e},function(e){return t(),ft(e)})},stack:{get:function(){if(this._stack)return this._stack;try{Vt=!0;var t=tr(this,[],qr),e=t.join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{Vt=!1}}},timeout:function(t,e){var n=this;return t<1/0?new k(function(r,i){var a=setTimeout(function(){return i(new K.Timeout(e))},t);n.then(r,i).finally(clearTimeout.bind(null,a))}):this}});typeof Symbol!="undefined"&&Symbol.toStringTag&&oe(k.prototype,Symbol.toStringTag,"Dexie.Promise");De.env=rr();function Jn(t,e,n,r,i){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=r,this.psd=i}Ie(k,{all:function(){var t=ie.apply(null,arguments).map(gt);return new k(function(e,n){t.length===0&&e([]);var r=t.length;t.forEach(function(i,a){return k.resolve(i).then(function(u){t[a]=u,--r||e(t)},n)})})},resolve:function(t){if(t instanceof k)return t;if(t&&typeof t.then=="function")return new k(function(n,r){t.then(n,r)});var e=new k(Ue,!0,t);return nr(e,Ut),e},reject:ft,race:function(){var t=ie.apply(null,arguments).map(gt);return new k(function(e,n){t.map(function(r){return k.resolve(r).then(e,n)})})},PSD:{get:function(){return A},set:function(t){return A=t}},totalEchoes:{get:function(){return mt}},newPSD:ve,usePSD:Oe,scheduler:{get:function(){return We},set:function(t){We=t}},rejectionMapper:{get:function(){return Wt},set:function(t){Wt=t}},follow:function(t,e){return new k(function(n,r){return ve(function(i,a){var u=A;u.unhandleds=[],u.onunhandled=a,u.finalize=xe(function(){var o=this;ei(function(){o.unhandleds.length===0?i():a(o.unhandleds[0])})},u.finalize),t()},e,n,r)})}});st&&(st.allSettled&&oe(k,"allSettled",function(){var t=ie.apply(null,arguments).map(gt);return new k(function(e){t.length===0&&e([]);var n=t.length,r=new Array(n);t.forEach(function(i,a){return k.resolve(i).then(function(u){return r[a]={status:"fulfilled",value:u}},function(u){return r[a]={status:"rejected",reason:u}}).then(function(){return--n||e(r)})})})}),st.any&&typeof AggregateError!="undefined"&&oe(k,"any",function(){var t=ie.apply(null,arguments).map(gt);return new k(function(e,n){t.length===0&&n(new AggregateError([]));var r=t.length,i=new Array(r);t.forEach(function(a,u){return k.resolve(a).then(function(o){return e(o)},function(o){i[u]=o,--r||n(new AggregateError(i))})})})}));function Zn(t,e){try{e(function(n){if(t._state===null){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&Je();n&&typeof n.then=="function"?Zn(t,function(i,a){n instanceof k?n._then(i,a):n.then(i,a)}):(t._state=!0,t._value=n,er(t)),r&&Ze()}},$t.bind(null,t))}catch(n){$t(t,n)}}function $t(t,e){if(ct.push(e),t._state===null){var n=t._lib&&Je();e=Wt(e),t._state=!1,t._value=e,te&&e!==null&&typeof e=="object"&&!e._promise&&Br(function(){var r=on(e,"stack");e._promise=t,oe(e,"stack",{get:function(){return Vt?r&&(r.get?r.get.apply(e):r.value):t.stack}})}),ti(t),er(t),n&&Ze()}}function er(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)vn(t,e[n]);var i=t._PSD;--i.ref||i.finalize(),we===0&&(++we,We(function(){--we===0&&pn()},[]))}function vn(t,e){if(t._state===null){t._listeners.push(e);return}var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++we,We(Zr,[n,t,e])}function Zr(t,e,n){try{Ut=e;var r,i=e._value;e._state?r=t(i):(ct.length&&(ct=[]),r=t(i),ct.indexOf(i)===-1&&ni(e)),n.resolve(r)}catch(a){n.reject(a)}finally{Ut=null,--we===0&&pn(),--n.psd.ref||n.psd.finalize()}}function tr(t,e,n){if(e.length===n)return e;var r="";if(t._state===!1){var i=t._value,a,u;i!=null?(a=i.name||"Error",u=i.message||i,r=Nt(i,0)):(a=i,u=""),e.push(a+(u?": "+u:"")+r)}return te&&(r=Nt(t._stackHolder,2),r&&e.indexOf(r)===-1&&e.push(r),t._prev&&tr(t._prev,e,n)),e}function nr(t,e){var n=e?e._numPrev+1:0;n<Gr&&(t._prev=e,t._numPrev=n)}function rt(){Je()&&Ze()}function Je(){var t=Ht;return Ht=!1,yt=!1,t}function Ze(){var t,e,n;do for(;ze.length>0;)for(t=ze,ze=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}while(ze.length>0);Ht=!0,yt=!0}function pn(){var t=be;be=[],t.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var e=lt.slice(0),n=e.length;n;)e[--n]()}function ei(t){function e(){t(),lt.splice(lt.indexOf(e),1)}lt.push(e),++we,We(function(){--we===0&&pn()},[])}function ti(t){be.some(function(e){return e._value===t._value})||be.push(t)}function ni(t){for(var e=be.length;e;)if(be[--e]._value===t._value){be.splice(e,1);return}}function ft(t){return new k(Ue,!1,t)}function F(t,e){var n=A;return function(){var r=Je(),i=A;try{return pe(n,!0),t.apply(this,arguments)}catch(a){e&&e(a)}finally{pe(i,!1),r&&Ze()}}}var L={awaits:0,echoes:0,id:0},ri=0,ht=[],Kt=0,mt=0,ii=0;function ve(t,e,n,r){var i=A,a=Object.create(i);a.parent=i,a.ref=0,a.global=!1,a.id=++ii;var u=De.env;a.env=dn?{Promise:k,PromiseProp:{value:k,configurable:!0,writable:!0},all:k.all,race:k.race,allSettled:k.allSettled,any:k.any,resolve:k.resolve,reject:k.reject,nthen:Cn(u.nthen,a),gthen:Cn(u.gthen,a)}:{},e&&U(a,e),++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var o=Oe(a,t,n,r);return a.ref===0&&a.finalize(),o}function Be(){return L.id||(L.id=++ri),++L.awaits,L.echoes+=Gn,L.id}function se(){return L.awaits?(--L.awaits===0&&(L.id=0),L.echoes=L.awaits*Gn,!0):!1}(""+qn).indexOf("[native code]")===-1&&(Be=se=O);function gt(t){return L.echoes&&t&&t.constructor===st?(Be(),t.then(function(e){return se(),e},function(e){return se(),N(e)})):t}function ai(t){++mt,(!L.echoes||--L.echoes===0)&&(L.echoes=L.id=0),ht.push(A),pe(t,!0)}function ui(){var t=ht[ht.length-1];ht.pop(),pe(t,!1)}function pe(t,e){var n=A;if((e?L.echoes&&(!Kt++||t!==A):Kt&&(!--Kt||t!==A))&&ir(e?ai.bind(null,t):ui),t!==A&&(A=t,n===De&&(De.env=rr()),dn)){var r=De.env.Promise,i=t.env;pt.then=i.nthen,r.prototype.then=i.gthen,(n.global||t.global)&&(Object.defineProperty(M,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function rr(){var t=M.Promise;return dn?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(M,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:pt.then,gthen:t.prototype.then}:{}}function Oe(t,e,n,r,i){var a=A;try{return pe(t,!0),e(n,r,i)}finally{pe(a,!1)}}function ir(t){qn.call(jt,t)}function _t(t,e,n,r){return typeof t!="function"?t:function(){var i=A;n&&Be(),pe(e,!0);try{return t.apply(this,arguments)}finally{pe(i,!1),r&&ir(se)}}}function Cn(t,e){return function(n,r){return t.call(this,_t(n,e),_t(r,e))}}var Sn="unhandledrejection";function Kn(t,e){var n;try{n=e.onuncatched(t)}catch{}if(n!==!1)try{var r,i={promise:e,reason:t};if(M.document&&document.createEvent?(r=document.createEvent("Event"),r.initEvent(Sn,!0,!0),U(r,i)):M.CustomEvent&&(r=new CustomEvent(Sn,{detail:i}),U(r,i)),r&&M.dispatchEvent&&(dispatchEvent(r),!M.PromiseRejectionEvent&&M.onunhandledrejection))try{M.onunhandledrejection(r)}catch{}te&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(t.stack||t))}catch{}}var N=k.reject;function Qt(t,e,n,r){if(!t.idbdb||!t._state.openComplete&&!A.letThrough&&!t._vip){if(t._state.openComplete)return N(new K.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return N(new K.DatabaseClosed);t.open().catch(O)}return t._state.dbReadyPromise.then(function(){return Qt(t,e,n,r)})}else{var i=t._createTransaction(e,n,t._dbSchema);try{i.create(),t._state.PR1398_maxLoop=3}catch(a){return a.name===ln.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(function(){return Qt(t,e,n,r)})):N(a)}return i._promise(e,function(a,u){return ve(function(){return A.trans=i,r(a,u,i)})}).then(function(a){return i._completion.then(function(){return a})})}}var Tn="3.2.1",ge=String.fromCharCode(65535),Xt=-1/0,ne="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ar="String expected.",Le=[],At=typeof navigator!="undefined"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),oi=At,si=At,ur=function(t){return!/(dexie\.js|dexie\.min\.js)/.test(t)},Ct="__dbnames",Tt="readonly",Dt="readwrite";function Ee(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}var or={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function it(t){return typeof t=="string"&&!/\./.test(t)?function(e){return e[t]===void 0&&t in e&&(e=Ge(e),delete e[t]),e}:function(e){return e}}var ci=function(){function t(){}return t.prototype._trans=function(e,n,r){var i=this._tx||A.trans,a=this.name;function u(s,c,f){if(!f.schema[a])throw new K.NotFound("Table "+a+" not part of transaction");return n(f.idbtrans,f)}var o=Je();try{return i&&i.db===this.db?i===A.trans?i._promise(e,u,r):ve(function(){return i._promise(e,u,r)},{trans:i,transless:A.transless||A}):Qt(this.db,e,[this.name],u)}finally{o&&Ze()}},t.prototype.get=function(e,n){var r=this;return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",function(i){return r.core.get({trans:i,key:e}).then(function(a){return r.hook.reading.fire(a)})}).then(n)},t.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(V(e))return new this.db.WhereClause(this,"["+e.join("+")+"]");var n=z(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(f){return f.compound&&n.every(function(l){return f.keyPath.indexOf(l)>=0})&&f.keyPath.every(function(l){return n.indexOf(l)>=0})})[0];if(r&&this.db._maxKey!==ge)return this.where(r.name).equals(r.keyPath.map(function(f){return e[f]}));!r&&te&&console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a "+("compound index ["+n.join("+")+"]"));var i=this.schema.idxByName,a=this.db._deps.indexedDB;function u(f,l){try{return a.cmp(f,l)===0}catch{return!1}}var o=n.reduce(function(f,l){var d=f[0],_=f[1],v=i[l],h=e[l];return[d||v,d||!v?Ee(_,v&&v.multi?function(y){var b=ue(y,l);return V(b)&&b.some(function(w){return u(h,w)})}:function(y){return u(h,ue(y,l))}):_]},[null,null]),s=o[0],c=o[1];return s?this.where(s.name).equals(e[s.keyPath]).filter(c):r?this.filter(c):this.where(n).equals("")},t.prototype.filter=function(e){return this.toCollection().and(e)},t.prototype.count=function(e){return this.toCollection().count(e)},t.prototype.offset=function(e){return this.toCollection().offset(e)},t.prototype.limit=function(e){return this.toCollection().limit(e)},t.prototype.each=function(e){return this.toCollection().each(e)},t.prototype.toArray=function(e){return this.toCollection().toArray(e)},t.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},t.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,V(e)?"["+e.join("+")+"]":e))},t.prototype.reverse=function(){return this.toCollection().reverse()},t.prototype.mapToClass=function(e){this.schema.mappedClass=e;var n=function(r){if(!r)return r;var i=Object.create(e.prototype);for(var a in r)if(Q(r,a))try{i[a]=r[a]}catch{}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e},t.prototype.defineClass=function(){function e(n){U(this,n)}return this.mapToClass(e)},t.prototype.add=function(e,n){var r=this,i=this.schema.primKey,a=i.auto,u=i.keyPath,o=e;return u&&a&&(o=it(u)(e)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"add",keys:n!=null?[n]:null,values:[o]})}).then(function(s){return s.numFailures?k.reject(s.failures[0]):s.lastResult}).then(function(s){if(u)try{q(e,u,s)}catch{}return s})},t.prototype.update=function(e,n){if(typeof e=="object"&&!V(e)){var r=ue(e,this.schema.primKey.keyPath);if(r===void 0)return N(new K.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?z(n).forEach(function(i){q(e,i,n[i])}):n(e,{value:e,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}else return this.where(":id").equals(e).modify(n)},t.prototype.put=function(e,n){var r=this,i=this.schema.primKey,a=i.auto,u=i.keyPath,o=e;return u&&a&&(o=it(u)(e)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"put",values:[o],keys:n!=null?[n]:null})}).then(function(s){return s.numFailures?k.reject(s.failures[0]):s.lastResult}).then(function(s){if(u)try{q(e,u,s)}catch{}return s})},t.prototype.delete=function(e){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:[e]})}).then(function(r){return r.numFailures?k.reject(r.failures[0]):void 0})},t.prototype.clear=function(){var e=this;return this._trans("readwrite",function(n){return e.core.mutate({trans:n,type:"deleteRange",range:or})}).then(function(n){return n.numFailures?k.reject(n.failures[0]):void 0})},t.prototype.bulkGet=function(e){var n=this;return this._trans("readonly",function(r){return n.core.getMany({keys:e,trans:r}).then(function(i){return i.map(function(a){return n.hook.reading.fire(a)})})})},t.prototype.bulkAdd=function(e,n,r){var i=this,a=Array.isArray(n)?n:void 0;r=r||(a?void 0:n);var u=r?r.allKeys:void 0;return this._trans("readwrite",function(o){var s=i.schema.primKey,c=s.auto,f=s.keyPath;if(f&&a)throw new K.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new K.InvalidArgument("Arguments objects and keys must have the same length");var l=e.length,d=f&&c?e.map(it(f)):e;return i.core.mutate({trans:o,type:"add",keys:a,values:d,wantResults:u}).then(function(_){var v=_.numFailures,h=_.results,y=_.lastResult,b=_.failures,w=u?h:y;if(v===0)return w;throw new je(i.name+".bulkAdd(): "+v+" of "+l+" operations failed",b)})})},t.prototype.bulkPut=function(e,n,r){var i=this,a=Array.isArray(n)?n:void 0;r=r||(a?void 0:n);var u=r?r.allKeys:void 0;return this._trans("readwrite",function(o){var s=i.schema.primKey,c=s.auto,f=s.keyPath;if(f&&a)throw new K.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==e.length)throw new K.InvalidArgument("Arguments objects and keys must have the same length");var l=e.length,d=f&&c?e.map(it(f)):e;return i.core.mutate({trans:o,type:"put",keys:a,values:d,wantResults:u}).then(function(_){var v=_.numFailures,h=_.results,y=_.lastResult,b=_.failures,w=u?h:y;if(v===0)return w;throw new je(i.name+".bulkPut(): "+v+" of "+l+" operations failed",b)})})},t.prototype.bulkDelete=function(e){var n=this,r=e.length;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"delete",keys:e})}).then(function(i){var a=i.numFailures,u=i.lastResult,o=i.failures;if(a===0)return u;throw new je(n.name+".bulkDelete(): "+a+" of "+r+" operations failed",o)})},t}();function et(t){var e={},n=function(o,s){if(s){for(var c=arguments.length,f=new Array(c-1);--c;)f[c-1]=arguments[c];return e[o].subscribe.apply(null,f),t}else if(typeof o=="string")return e[o]};n.addEventType=a;for(var r=1,i=arguments.length;r<i;++r)a(arguments[r]);return n;function a(o,s,c){if(typeof o=="object")return u(o);s||(s=Xr),c||(c=O);var f={subscribers:[],fire:c,subscribe:function(l){f.subscribers.indexOf(l)===-1&&(f.subscribers.push(l),f.fire=s(f.fire,l))},unsubscribe:function(l){f.subscribers=f.subscribers.filter(function(d){return d!==l}),f.fire=f.subscribers.reduce(s,c)}};return e[o]=n[o]=f,f}function u(o){z(o).forEach(function(s){var c=o[s];if(V(c))a(s,o[s][0],o[s][1]);else if(c==="asap")var f=a(s,qe,function(){for(var d=arguments.length,_=new Array(d);d--;)_[d]=arguments[d];f.subscribers.forEach(function(v){Ln(function(){v.apply(null,_)})})});else throw new K.InvalidArgument("Invalid event config")})}}function tt(t,e){return Pe(e).from({prototype:t}),e}function li(t){return tt(ci.prototype,function(n,r,i){this.db=t,this._tx=i,this.name=n,this.schema=r,this.hook=t._allTables[n]?t._allTables[n].hook:et(null,{creating:[Yr,O],reading:[Wr,qe],updating:[Qr,O],deleting:[$r,O]})})}function Ae(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function It(t,e){t.filter=Ee(t.filter,e)}function Pt(t,e,n){var r=t.replayFilter;t.replayFilter=r?function(){return Ee(r(),e())}:e,t.justLimit=n&&!r}function fi(t,e){t.isMatch=Ee(t.isMatch,e)}function dt(t,e){if(t.isPrimKey)return e.primaryKey;var n=e.getIndexByKeyPath(t.index);if(!n)throw new K.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function Dn(t,e,n){var r=dt(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:r,range:t.range}})}function at(t,e,n,r){var i=t.replayFilter?Ee(t.filter,t.replayFilter()):t.filter;if(t.or){var a={},u=function(o,s,c){if(!i||i(s,c,function(d){return s.stop(d)},function(d){return s.fail(d)})){var f=s.primaryKey,l=""+f;l==="[object ArrayBuffer]"&&(l=""+new Uint8Array(f)),Q(a,l)||(a[l]=!0,e(o,s,c))}};return Promise.all([t.or._iterate(u,n),In(Dn(t,r,n),t.algorithm,u,!t.keysOnly&&t.valueMapper)])}else return In(Dn(t,r,n),Ee(t.algorithm,i),e,!t.keysOnly&&t.valueMapper)}function In(t,e,n,r){var i=r?function(u,o,s){return n(r(u),o,s)}:n,a=F(i);return t.then(function(u){if(u)return u.start(function(){var o=function(){return u.continue()};(!e||e(u,function(s){return o=s},function(s){u.stop(s),o=O},function(s){u.fail(s),o=O}))&&a(u.value,u,function(s){return o=s}),o()})})}function H(t,e){try{var n=Pn(t),r=Pn(e);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return di(Rn(t),Rn(e));case"Array":return hi(t,e)}}catch{}return NaN}function hi(t,e){for(var n=t.length,r=e.length,i=n<r?n:r,a=0;a<i;++a){var u=H(t[a],e[a]);if(u!==0)return u}return n===r?0:n<r?-1:1}function di(t,e){for(var n=t.length,r=e.length,i=n<r?n:r,a=0;a<i;++a)if(t[a]!==e[a])return t[a]<e[a]?-1:1;return n===r?0:n<r?-1:1}function Pn(t){var e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";var n=Ft(t);return n==="ArrayBuffer"?"binary":n}function Rn(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}var vi=function(){function t(){}return t.prototype._read=function(e,n){var r=this._ctx;return r.error?r.table._trans(null,N.bind(null,r.error)):r.table._trans("readonly",e).then(n)},t.prototype._write=function(e){var n=this._ctx;return n.error?n.table._trans(null,N.bind(null,n.error)):n.table._trans("readwrite",e,"locked")},t.prototype._addAlgorithm=function(e){var n=this._ctx;n.algorithm=Ee(n.algorithm,e)},t.prototype._iterate=function(e,n){return at(this._ctx,e,n,this._ctx.table.core)},t.prototype.clone=function(e){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&U(r,e),n._ctx=r,n},t.prototype.raw=function(){return this._ctx.valueMapper=null,this},t.prototype.each=function(e){var n=this._ctx;return this._read(function(r){return at(n,e,r,n.table.core)})},t.prototype.count=function(e){var n=this;return this._read(function(r){var i=n._ctx,a=i.table.core;if(Ae(i,!0))return a.count({trans:r,query:{index:dt(i,a.schema),range:i.range}}).then(function(o){return Math.min(o,i.limit)});var u=0;return at(i,function(){return++u,!1},r,a).then(function(){return u})}).then(e)},t.prototype.sortBy=function(e,n){var r=e.split(".").reverse(),i=r[0],a=r.length-1;function u(c,f){return f?u(c[r[f]],f-1):c[i]}var o=this._ctx.dir==="next"?1:-1;function s(c,f){var l=u(c,a),d=u(f,a);return l<d?-o:l>d?o:0}return this.toArray(function(c){return c.sort(s)}).then(n)},t.prototype.toArray=function(e){var n=this;return this._read(function(r){var i=n._ctx;if(i.dir==="next"&&Ae(i,!0)&&i.limit>0){var a=i.valueMapper,u=dt(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:u,range:i.range}}).then(function(s){var c=s.result;return a?c.map(a):c})}else{var o=[];return at(i,function(s){return o.push(s)},r,i.table.core).then(function(){return o})}},e)},t.prototype.offset=function(e){var n=this._ctx;return e<=0?this:(n.offset+=e,Ae(n)?Pt(n,function(){var r=e;return function(i,a){return r===0?!0:r===1?(--r,!1):(a(function(){i.advance(r),r=0}),!1)}}):Pt(n,function(){var r=e;return function(){return--r<0}}),this)},t.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Pt(this._ctx,function(){var n=e;return function(r,i,a){return--n<=0&&i(a),n>=0}},!0),this},t.prototype.until=function(e,n){return It(this._ctx,function(r,i,a){return e(r.value)?(i(a),n):!0}),this},t.prototype.first=function(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)},t.prototype.last=function(e){return this.reverse().first(e)},t.prototype.filter=function(e){return It(this._ctx,function(n){return e(n.value)}),fi(this._ctx,e),this},t.prototype.and=function(e){return this.filter(e)},t.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},t.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},t.prototype.desc=function(){return this.reverse()},t.prototype.eachKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){e(i.key,i)})},t.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},t.prototype.eachPrimaryKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){e(i.primaryKey,i)})},t.prototype.keys=function(e){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.key)}).then(function(){return r}).then(e)},t.prototype.primaryKeys=function(e){var n=this._ctx;if(n.dir==="next"&&Ae(n,!0)&&n.limit>0)return this._read(function(i){var a=dt(n,n.table.core.schema);return n.table.core.query({trans:i,values:!1,limit:n.limit,query:{index:a,range:n.range}})}).then(function(i){var a=i.result;return a}).then(e);n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.primaryKey)}).then(function(){return r}).then(e)},t.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},t.prototype.firstKey=function(e){return this.limit(1).keys(function(n){return n[0]}).then(e)},t.prototype.lastKey=function(e){return this.reverse().firstKey(e)},t.prototype.distinct=function(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return It(this._ctx,function(i){var a=i.primaryKey.toString(),u=Q(r,a);return r[a]=!0,!u}),this},t.prototype.modify=function(e){var n=this,r=this._ctx;return this._write(function(i){var a;if(typeof e=="function")a=e;else{var u=z(e),o=u.length;a=function(b){for(var w=!1,m=0;m<o;++m){var g=u[m],p=e[g];ue(b,g)!==p&&(q(b,g,p),w=!0)}return w}}var s=r.table.core,c=s.schema.primaryKey,f=c.outbound,l=c.extractKey,d=n.db._options.modifyChunkSize||200,_=[],v=0,h=[],y=function(b,w){var m=w.failures,g=w.numFailures;v+=b-g;for(var p=0,x=z(m);p<x.length;p++){var C=x[p];_.push(m[C])}};return n.clone().primaryKeys().then(function(b){var w=function(m){var g=Math.min(d,b.length-m);return s.getMany({trans:i,keys:b.slice(m,m+g),cache:"immutable"}).then(function(p){for(var x=[],C=[],E=f?[]:null,S=[],T=0;T<g;++T){var R=p[T],B={value:Ge(R),primKey:b[m+T]};a.call(B,B.value,B)!==!1&&(B.value==null?S.push(b[m+T]):!f&&H(l(R),l(B.value))!==0?(S.push(b[m+T]),x.push(B.value)):(C.push(B.value),f&&E.push(b[m+T])))}var P=Ae(r)&&r.limit===1/0&&(typeof e!="function"||e===Rt)&&{index:r.index,range:r.range};return Promise.resolve(x.length>0&&s.mutate({trans:i,type:"add",values:x}).then(function(j){for(var D in j.failures)S.splice(parseInt(D),1);y(x.length,j)})).then(function(){return(C.length>0||P&&typeof e=="object")&&s.mutate({trans:i,type:"put",keys:E,values:C,criteria:P,changeSpec:typeof e!="function"&&e}).then(function(j){return y(C.length,j)})}).then(function(){return(S.length>0||P&&e===Rt)&&s.mutate({trans:i,type:"delete",keys:S,criteria:P}).then(function(j){return y(S.length,j)})}).then(function(){return b.length>m+g&&w(m+d)})})};return w(0).then(function(){if(_.length>0)throw new vt("Error modifying one or more objects",_,v,h);return b.length})})})},t.prototype.delete=function(){var e=this._ctx,n=e.range;return Ae(e)&&(e.isPrimKey&&!si||n.type===3)?this._write(function(r){var i=e.table.core.schema.primaryKey,a=n;return e.table.core.count({trans:r,query:{index:i,range:a}}).then(function(u){return e.table.core.mutate({trans:r,type:"deleteRange",range:a}).then(function(o){var s=o.failures;o.lastResult,o.results;var c=o.numFailures;if(c)throw new vt("Could not delete some values",Object.keys(s).map(function(f){return s[f]}),u-c);return u-c})})}):this.modify(Rt)},t}(),Rt=function(t,e){return e.value=null};function pi(t){return tt(vi.prototype,function(n,r){this.db=t;var i=or,a=null;if(r)try{i=r()}catch(c){a=c}var u=n._ctx,o=u.table,s=o.hook.reading.fire;this._ctx={table:o,index:u.index,isPrimKey:!u.index||o.schema.primKey.keyPath&&u.index===o.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:a,or:u.or,valueMapper:s!==qe?s:null}})}function yi(t,e){return t<e?-1:t===e?0:1}function mi(t,e){return t>e?-1:t===e?0:1}function W(t,e,n){var r=t instanceof cr?new t.Collection(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function Ce(t){return new t.Collection(t,function(){return sr("")}).limit(0)}function gi(t){return t==="next"?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}function _i(t){return t==="next"?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}function bi(t,e,n,r,i,a){for(var u=Math.min(t.length,r.length),o=-1,s=0;s<u;++s){var c=e[s];if(c!==r[s])return i(t[s],n[s])<0?t.substr(0,s)+n[s]+n.substr(s+1):i(t[s],r[s])<0?t.substr(0,s)+r[s]+n.substr(s+1):o>=0?t.substr(0,o)+e[o]+n.substr(o+1):null;i(t[s],c)<0&&(o=s)}return u<r.length&&a==="next"?t+n.substr(t.length):u<t.length&&a==="prev"?t.substr(0,n.length):o<0?null:t.substr(0,o)+r[o]+n.substr(o+1)}function ut(t,e,n,r){var i,a,u,o,s,c,f,l=n.length;if(!n.every(function(h){return typeof h=="string"}))return W(t,ar);function d(h){i=gi(h),a=_i(h),u=h==="next"?yi:mi;var y=n.map(function(b){return{lower:a(b),upper:i(b)}}).sort(function(b,w){return u(b.lower,w.lower)});o=y.map(function(b){return b.upper}),s=y.map(function(b){return b.lower}),c=h,f=h==="next"?"":r}d("next");var _=new t.Collection(t,function(){return fe(o[0],s[l-1]+r)});_._ondirectionchange=function(h){d(h)};var v=0;return _._addAlgorithm(function(h,y,b){var w=h.key;if(typeof w!="string")return!1;var m=a(w);if(e(m,s,v))return!0;for(var g=null,p=v;p<l;++p){var x=bi(w,m,o[p],s[p],u,c);x===null&&g===null?v=p+1:(g===null||u(g,x)>0)&&(g=x)}return y(g!==null?function(){h.continue(g+f)}:b),!1}),_}function fe(t,e,n,r){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:r}}function sr(t){return{type:1,lower:t,upper:t}}var cr=function(){function t(){}return Object.defineProperty(t.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),t.prototype.between=function(e,n,r,i){r=r!==!1,i=i===!0;try{return this._cmp(e,n)>0||this._cmp(e,n)===0&&(r||i)&&!(r&&i)?Ce(this):new this.Collection(this,function(){return fe(e,n,!r,!i)})}catch{return W(this,ne)}},t.prototype.equals=function(e){return e==null?W(this,ne):new this.Collection(this,function(){return sr(e)})},t.prototype.above=function(e){return e==null?W(this,ne):new this.Collection(this,function(){return fe(e,void 0,!0)})},t.prototype.aboveOrEqual=function(e){return e==null?W(this,ne):new this.Collection(this,function(){return fe(e,void 0,!1)})},t.prototype.below=function(e){return e==null?W(this,ne):new this.Collection(this,function(){return fe(void 0,e,!1,!0)})},t.prototype.belowOrEqual=function(e){return e==null?W(this,ne):new this.Collection(this,function(){return fe(void 0,e)})},t.prototype.startsWith=function(e){return typeof e!="string"?W(this,ar):this.between(e,e+ge,!0,!0)},t.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):ut(this,function(n,r){return n.indexOf(r[0])===0},[e],ge)},t.prototype.equalsIgnoreCase=function(e){return ut(this,function(n,r){return n===r[0]},[e],"")},t.prototype.anyOfIgnoreCase=function(){var e=ie.apply(Se,arguments);return e.length===0?Ce(this):ut(this,function(n,r){return r.indexOf(n)!==-1},e,"")},t.prototype.startsWithAnyOfIgnoreCase=function(){var e=ie.apply(Se,arguments);return e.length===0?Ce(this):ut(this,function(n,r){return r.some(function(i){return n.indexOf(i)===0})},e,ge)},t.prototype.anyOf=function(){var e=this,n=ie.apply(Se,arguments),r=this._cmp;try{n.sort(r)}catch{return W(this,ne)}if(n.length===0)return Ce(this);var i=new this.Collection(this,function(){return fe(n[0],n[n.length-1])});i._ondirectionchange=function(u){r=u==="next"?e._ascending:e._descending,n.sort(r)};var a=0;return i._addAlgorithm(function(u,o,s){for(var c=u.key;r(c,n[a])>0;)if(++a,a===n.length)return o(s),!1;return r(c,n[a])===0?!0:(o(function(){u.continue(n[a])}),!1)}),i},t.prototype.notEqual=function(e){return this.inAnyRange([[Xt,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},t.prototype.noneOf=function(){var e=ie.apply(Se,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return W(this,ne)}var n=e.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[Xt,i]]},null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},t.prototype.inAnyRange=function(e,n){var r=this,i=this._cmp,a=this._ascending,u=this._descending,o=this._min,s=this._max;if(e.length===0)return Ce(this);if(!e.every(function(p){return p[0]!==void 0&&p[1]!==void 0&&a(p[0],p[1])<=0}))return W(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",K.InvalidArgument);var c=!n||n.includeLowers!==!1,f=n&&n.includeUppers===!0;function l(p,x){for(var C=0,E=p.length;C<E;++C){var S=p[C];if(i(x[0],S[1])<0&&i(x[1],S[0])>0){S[0]=o(S[0],x[0]),S[1]=s(S[1],x[1]);break}}return C===E&&p.push(x),p}var d=a;function _(p,x){return d(p[0],x[0])}var v;try{v=e.reduce(l,[]),v.sort(_)}catch{return W(this,ne)}var h=0,y=f?function(p){return a(p,v[h][1])>0}:function(p){return a(p,v[h][1])>=0},b=c?function(p){return u(p,v[h][0])>0}:function(p){return u(p,v[h][0])>=0};function w(p){return!y(p)&&!b(p)}var m=y,g=new this.Collection(this,function(){return fe(v[0][0],v[v.length-1][1],!c,!f)});return g._ondirectionchange=function(p){p==="next"?(m=y,d=a):(m=b,d=u),v.sort(_)},g._addAlgorithm(function(p,x,C){for(var E=p.key;m(E);)if(++h,h===v.length)return x(C),!1;return w(E)?!0:(r._cmp(E,v[h][1])===0||r._cmp(E,v[h][0])===0||x(function(){d===a?p.continue(v[h][0]):p.continue(v[h][1])}),!1)}),g},t.prototype.startsWithAnyOf=function(){var e=ie.apply(Se,arguments);return e.every(function(n){return typeof n=="string"})?e.length===0?Ce(this):this.inAnyRange(e.map(function(n){return[n,n+ge]})):W(this,"startsWithAnyOf() only works with strings")},t}();function wi(t){return tt(cr.prototype,function(n,r,i){this.db=t,this._ctx={table:n,index:r===":id"?null:r,or:i};var a=t._deps.indexedDB;if(!a)throw new K.MissingAPI;this._cmp=this._ascending=a.cmp.bind(a),this._descending=function(u,o){return a.cmp(o,u)},this._max=function(u,o){return a.cmp(u,o)>0?u:o},this._min=function(u,o){return a.cmp(u,o)<0?u:o},this._IDBKeyRange=t._deps.IDBKeyRange})}function ee(t){return F(function(e){return Ye(e),t(e.target.error),!1})}function Ye(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}var $e="storagemutated",de="x-storagemutated-1",ye=et(null,$e),xi=function(){function t(){}return t.prototype._lock=function(){return Fe(!A.global),++this._reculock,this._reculock===1&&!A.global&&(A.lockOwnerFor=this),this},t.prototype._unlock=function(){if(Fe(!A.global),--this._reculock===0)for(A.global||(A.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{Oe(e[1],e[0])}catch{}}return this},t.prototype._locked=function(){return this._reculock&&A.lockOwnerFor!==this},t.prototype.create=function(e){var n=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(Fe(!this.idbtrans),!e&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new K.DatabaseClosed(i);case"MissingAPIError":throw new K.MissingAPI(i.message,i);default:throw new K.OpenFailed(i)}if(!this.active)throw new K.TransactionInactive;return Fe(this._completion._state===null),e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),e.onerror=F(function(a){Ye(a),n._reject(e.error)}),e.onabort=F(function(a){Ye(a),n.active&&n._reject(new K.Abort(e.error)),n.active=!1,n.on("abort").fire(a)}),e.oncomplete=F(function(){n.active=!1,n._resolve(),"mutatedParts"in e&&ye.storagemutated.fire(e.mutatedParts)}),this},t.prototype._promise=function(e,n,r){var i=this;if(e==="readwrite"&&this.mode!=="readwrite")return N(new K.ReadOnly("Transaction is readonly"));if(!this.active)return N(new K.TransactionInactive);if(this._locked())return new k(function(u,o){i._blockedFuncs.push([function(){i._promise(e,n,r).then(u,o)},A])});if(r)return ve(function(){var u=new k(function(o,s){i._lock();var c=n(o,s,i);c&&c.then&&c.then(o,s)});return u.finally(function(){return i._unlock()}),u._lib=!0,u});var a=new k(function(u,o){var s=n(u,o,i);s&&s.then&&s.then(u,o)});return a._lib=!0,a},t.prototype._root=function(){return this.parent?this.parent._root():this},t.prototype.waitFor=function(e){var n=this._root(),r=k.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return r});else{n._waitingFor=r,n._waitingQueue=[];var i=n.idbtrans.objectStore(n.storeNames[0]);(function u(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(i.get(-1/0).onsuccess=u)})()}var a=n._waitingFor;return new k(function(u,o){r.then(function(s){return n._waitingQueue.push(F(u.bind(null,s)))},function(s){return n._waitingQueue.push(F(o.bind(null,s)))}).finally(function(){n._waitingFor===a&&(n._waitingFor=null)})})},t.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new K.Abort))},t.prototype.table=function(e){var n=this._memoizedTables||(this._memoizedTables={});if(Q(n,e))return n[e];var r=this.schema[e];if(!r)throw new K.NotFound("Table "+e+" not part of transaction");var i=new this.db.Table(e,r,this);return i.core=this.db.core.table(e),n[e]=i,i},t}();function Ei(t){return tt(xi.prototype,function(n,r,i,a,u){var o=this;this.db=t,this.mode=n,this.storeNames=r,this.schema=i,this.chromeTransactionDurability=a,this.idbtrans=null,this.on=et(this,"complete","error","abort"),this.parent=u||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new k(function(s,c){o._resolve=s,o._reject=c}),this._completion.then(function(){o.active=!1,o.on.complete.fire()},function(s){var c=o.active;return o.active=!1,o.on.error.fire(s),o.parent?o.parent._reject(s):c&&o.idbtrans&&o.idbtrans.abort(),N(s)})})}function Gt(t,e,n,r,i,a,u){return{name:t,keyPath:e,unique:n,multi:r,auto:i,compound:a,src:(n&&!u?"&":"")+(r?"*":"")+(i?"++":"")+lr(e)}}function lr(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function fr(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:Vn(n,function(r){return[r.name,r]})}}function ki(t){return t.length===1?t[0]:t}var Qe=function(t){try{return t.only([[]]),Qe=function(){return[[]]},[[]]}catch{return Qe=function(){return ge},ge}};function qt(t){return t==null?function(){}:typeof t=="string"?Ai(t):function(e){return ue(e,t)}}function Ai(t){var e=t.split(".");return e.length===1?function(n){return n[t]}:function(n){return ue(n,t)}}function Bn(t){return[].slice.call(t)}var Ci=0;function Ve(t){return t==null?":id":typeof t=="string"?t:"["+t.join("+")+"]"}function Si(t,e,n){function r(l,d){var _=Bn(l.objectStoreNames);return{schema:{name:l.name,tables:_.map(function(v){return d.objectStore(v)}).map(function(v){var h=v.keyPath,y=v.autoIncrement,b=V(h),w=h==null,m={},g={name:v.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:w,compound:b,keyPath:h,autoIncrement:y,unique:!0,extractKey:qt(h)},indexes:Bn(v.indexNames).map(function(p){return v.index(p)}).map(function(p){var x=p.name,C=p.unique,E=p.multiEntry,S=p.keyPath,T=V(S),R={name:x,compound:T,keyPath:S,unique:C,multiEntry:E,extractKey:qt(S)};return m[Ve(S)]=R,R}),getIndexByKeyPath:function(p){return m[Ve(p)]}};return m[":id"]=g.primaryKey,h!=null&&(m[Ve(h)]=g.primaryKey),g})},hasGetAll:_.length>0&&"getAll"in d.objectStore(_[0])&&!(typeof navigator!="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var d=l.lower,_=l.upper,v=l.lowerOpen,h=l.upperOpen,y=d===void 0?_===void 0?null:e.upperBound(_,!!h):_===void 0?e.lowerBound(d,!!v):e.bound(d,_,!!v,!!h);return y}function a(l){var d=l.name;function _(y){var b=y.trans,w=y.type,m=y.keys,g=y.values,p=y.range;return new Promise(function(x,C){x=F(x);var E=b.objectStore(d),S=E.keyPath==null,T=w==="put"||w==="add";if(!T&&w!=="delete"&&w!=="deleteRange")throw new Error("Invalid operation type: "+w);var R=(m||g||{length:1}).length;if(m&&g&&m.length!==g.length)throw new Error("Given keys array must have same length as given values array.");if(R===0)return x({numFailures:0,failures:{},results:[],lastResult:void 0});var B,P=[],j=[],D=0,Y=function(Z){++D,Ye(Z)};if(w==="deleteRange"){if(p.type===4)return x({numFailures:D,failures:j,results:[],lastResult:void 0});p.type===3?P.push(B=E.clear()):P.push(B=E.delete(i(p)))}else{var X=T?S?[g,m]:[g,null]:[m,null],ce=X[0],J=X[1];if(T)for(var $=0;$<R;++$)P.push(B=J&&J[$]!==void 0?E[w](ce[$],J[$]):E[w](ce[$])),B.onerror=Y;else for(var $=0;$<R;++$)P.push(B=E[w](ce[$])),B.onerror=Y}var le=function(Z){var Me=Z.target.result;P.forEach(function(G,nt){return G.error!=null&&(j[nt]=G.error)}),x({numFailures:D,failures:j,results:w==="delete"?m:P.map(function(G){return G.result}),lastResult:Me})};B.onerror=function(Z){Y(Z),le(Z)},B.onsuccess=le})}function v(y){var b=y.trans,w=y.values,m=y.query,g=y.reverse,p=y.unique;return new Promise(function(x,C){x=F(x);var E=m.index,S=m.range,T=b.objectStore(d),R=E.isPrimaryKey?T:T.index(E.name),B=g?p?"prevunique":"prev":p?"nextunique":"next",P=w||!("openKeyCursor"in R)?R.openCursor(i(S),B):R.openKeyCursor(i(S),B);P.onerror=ee(C),P.onsuccess=F(function(j){var D=P.result;if(!D){x(null);return}D.___id=++Ci,D.done=!1;var Y=D.continue.bind(D),X=D.continuePrimaryKey;X&&(X=X.bind(D));var ce=D.advance.bind(D),J=function(){throw new Error("Cursor not started")},$=function(){throw new Error("Cursor not stopped")};D.trans=b,D.stop=D.continue=D.continuePrimaryKey=D.advance=J,D.fail=F(C),D.next=function(){var le=this,Z=1;return this.start(function(){return Z--?le.continue():le.stop()}).then(function(){return le})},D.start=function(le){var Z=new Promise(function(G,nt){G=F(G),P.onerror=ee(nt),D.fail=nt,D.stop=function(yr){D.stop=D.continue=D.continuePrimaryKey=D.advance=$,G(yr)}}),Me=function(){if(P.result)try{le()}catch(G){D.fail(G)}else D.done=!0,D.start=function(){throw new Error("Cursor behind last entry")},D.stop()};return P.onsuccess=F(function(G){P.onsuccess=Me,Me()}),D.continue=Y,D.continuePrimaryKey=X,D.advance=ce,Me(),Z},x(D)},C)})}function h(y){return function(b){return new Promise(function(w,m){w=F(w);var g=b.trans,p=b.values,x=b.limit,C=b.query,E=x===1/0?void 0:x,S=C.index,T=C.range,R=g.objectStore(d),B=S.isPrimaryKey?R:R.index(S.name),P=i(T);if(x===0)return w({result:[]});if(y){var j=p?B.getAll(P,E):B.getAllKeys(P,E);j.onsuccess=function(ce){return w({result:ce.target.result})},j.onerror=ee(m)}else{var D=0,Y=p||!("openKeyCursor"in B)?B.openCursor(P):B.openKeyCursor(P),X=[];Y.onsuccess=function(ce){var J=Y.result;if(!J)return w({result:X});if(X.push(p?J.value:J.primaryKey),++D===x)return w({result:X});J.continue()},Y.onerror=ee(m)}})}}return{name:d,schema:l,mutate:_,getMany:function(y){var b=y.trans,w=y.keys;return new Promise(function(m,g){m=F(m);for(var p=b.objectStore(d),x=w.length,C=new Array(x),E=0,S=0,T,R=function(D){var Y=D.target;(C[Y._pos]=Y.result)!=null,++S===E&&m(C)},B=ee(g),P=0;P<x;++P){var j=w[P];j!=null&&(T=p.get(w[P]),T._pos=P,T.onsuccess=R,T.onerror=B,++E)}E===0&&m(C)})},get:function(y){var b=y.trans,w=y.key;return new Promise(function(m,g){m=F(m);var p=b.objectStore(d),x=p.get(w);x.onsuccess=function(C){return m(C.target.result)},x.onerror=ee(g)})},query:h(s),openCursor:v,count:function(y){var b=y.query,w=y.trans,m=b.index,g=b.range;return new Promise(function(p,x){var C=w.objectStore(d),E=m.isPrimaryKey?C:C.index(m.name),S=i(g),T=S?E.count(S):E.count();T.onsuccess=F(function(R){return p(R.target.result)}),T.onerror=ee(x)})}}}var u=r(t,n),o=u.schema,s=u.hasGetAll,c=o.tables.map(function(l){return a(l)}),f={};return c.forEach(function(l){return f[l.name]=l}),{stack:"dbcore",transaction:t.transaction.bind(t),table:function(l){var d=f[l];if(!d)throw new Error("Table '"+l+"' not found");return f[l]},MIN_KEY:-1/0,MAX_KEY:Qe(e),schema:o}}function Ki(t,e){return e.reduce(function(n,r){var i=r.create;return I(I({},n),i(n))},t)}function Ti(t,e,n,r){var i=n.IDBKeyRange;n.indexedDB;var a=Ki(Si(e,i,r),t.dbcore);return{dbcore:a}}function yn(t,e){var n=t._novip,r=e.db,i=Ti(n._middlewares,r,n._deps,e);n.core=i.dbcore,n.tables.forEach(function(a){var u=a.name;n.core.schema.tables.some(function(o){return o.name===u})&&(a.core=n.core.table(u),n[u]instanceof n.Table&&(n[u].core=a.core))})}function bt(t,e,n,r){var i=t._novip;n.forEach(function(a){var u=r[a];e.forEach(function(o){var s=on(o,a);(!s||"value"in s&&s.value===void 0)&&(o===i.Transaction.prototype||o instanceof i.Transaction?oe(o,a,{get:function(){return this.table(a)},set:function(c){Nn(this,a,{value:c,writable:!0,configurable:!0,enumerable:!0})}}):o[a]=new i.Table(a,u))})})}function Jt(t,e){var n=t._novip;e.forEach(function(r){for(var i in r)r[i]instanceof n.Table&&delete r[i]})}function Di(t,e){return t._cfg.version-e._cfg.version}function Ii(t,e,n,r){var i=t._dbSchema,a=t._createTransaction("readwrite",t._storeNames,i);a.create(n),a._completion.catch(r);var u=a._reject.bind(a),o=A.transless||A;ve(function(){A.trans=a,A.transless=o,e===0?(z(i).forEach(function(s){mn(n,s,i[s].primKey,i[s].indexes)}),yn(t,n),k.follow(function(){return t.on.populate.fire(a)}).catch(u)):Pi(t,e,a,n).catch(u)})}function Pi(t,e,n,r){var i=t._novip,a=[],u=i._versions,o=i._dbSchema=gn(i,i.idbdb,r),s=!1,c=u.filter(function(l){return l._cfg.version>=e});c.forEach(function(l){a.push(function(){var d=o,_=l._cfg.dbschema;en(i,d,r),en(i,_,r),o=i._dbSchema=_;var v=hr(d,_);v.add.forEach(function(g){mn(r,g[0],g[1].primKey,g[1].indexes)}),v.change.forEach(function(g){if(g.recreate)throw new K.Upgrade("Not yet support for changing primary key");var p=r.objectStore(g.name);g.add.forEach(function(x){return Zt(p,x)}),g.change.forEach(function(x){p.deleteIndex(x.name),Zt(p,x)}),g.del.forEach(function(x){return p.deleteIndex(x)})});var h=l._cfg.contentUpgrade;if(h&&l._cfg.version>e){yn(i,r),n._memoizedTables={},s=!0;var y=Hn(_);v.del.forEach(function(g){y[g]=d[g]}),Jt(i,[i.Transaction.prototype]),bt(i,[i.Transaction.prototype],z(y),y),n.schema=y;var b=sn(h);b&&Be();var w,m=k.follow(function(){if(w=h(n),w&&b){var g=se.bind(null,null);w.then(g,g)}});return w&&typeof w.then=="function"?k.resolve(w):m.then(function(){return w})}}),a.push(function(d){if(!s||!oi){var _=l._cfg.dbschema;Bi(_,d)}Jt(i,[i.Transaction.prototype]),bt(i,[i.Transaction.prototype],i._storeNames,i._dbSchema),n.schema=i._dbSchema})});function f(){return a.length?k.resolve(a.shift()(n.idbtrans)).then(f):k.resolve()}return f().then(function(){Ri(o,r)})}function hr(t,e){var n={del:[],add:[],change:[]},r;for(r in t)e[r]||n.del.push(r);for(r in e){var i=t[r],a=e[r];if(!i)n.add.push([r,a]);else{var u={name:r,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||i.primKey.auto!==a.primKey.auto&&!At)u.recreate=!0,n.change.push(u);else{var o=i.idxByName,s=a.idxByName,c=void 0;for(c in o)s[c]||u.del.push(c);for(c in s){var f=o[c],l=s[c];f?f.src!==l.src&&u.change.push(l):u.add.push(l)}(u.del.length>0||u.add.length>0||u.change.length>0)&&n.change.push(u)}}}return n}function mn(t,e,n,r){var i=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(a){return Zt(i,a)}),i}function Ri(t,e){z(t).forEach(function(n){e.db.objectStoreNames.contains(n)||mn(e,n,t[n].primKey,t[n].indexes)})}function Bi(t,e){[].slice.call(e.db.objectStoreNames).forEach(function(n){return t[n]==null&&e.db.deleteObjectStore(n)})}function Zt(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function gn(t,e,n){var r={},i=Et(e.objectStoreNames,0);return i.forEach(function(a){for(var u=n.objectStore(a),o=u.keyPath,s=Gt(lr(o),o||"",!1,!1,!!u.autoIncrement,o&&typeof o!="string",!0),c=[],f=0;f<u.indexNames.length;++f){var l=u.index(u.indexNames[f]);o=l.keyPath;var d=Gt(l.name,o,!!l.unique,!!l.multiEntry,!1,o&&typeof o!="string",!1);c.push(d)}r[a]=fr(a,s,c)}),r}function Oi(t,e,n){var r=t._novip;r.verno=e.version/10;var i=r._dbSchema=gn(r,e,n);r._storeNames=Et(e.objectStoreNames,0),bt(r,[r._allTables],z(i),i)}function Mi(t,e){var n=gn(t,t.idbdb,e),r=hr(n,t._dbSchema);return!(r.add.length||r.change.some(function(i){return i.add.length||i.change.length}))}function en(t,e,n){for(var r=t._novip,i=n.db.objectStoreNames,a=0;a<i.length;++a){var u=i[a],o=n.objectStore(u);r._hasGetAll="getAll"in o;for(var s=0;s<o.indexNames.length;++s){var c=o.indexNames[s],f=o.index(c).keyPath,l=typeof f=="string"?f:"["+Et(f).join("+")+"]";if(e[u]){var d=e[u].idxByName[l];d&&(d.name=c,delete e[u].idxByName[l],e[u].idxByName[c]=d)}}}typeof navigator!="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&M.WorkerGlobalScope&&M instanceof M.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}function Fi(t){return t.split(",").map(function(e,n){e=e.trim();var r=e.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return Gt(r,i||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),V(i),n===0)})}var zi=function(){function t(){}return t.prototype._parseStoresSpec=function(e,n){z(e).forEach(function(r){if(e[r]!==null){var i=Fi(e[r]),a=i.shift();if(a.multi)throw new K.Schema("Primary key cannot be multi-valued");i.forEach(function(u){if(u.auto)throw new K.Schema("Only primary key can be marked as autoIncrement (++)");if(!u.keyPath)throw new K.Schema("Index must have a name and cannot be an empty string")}),n[r]=fr(r,a,i)}})},t.prototype.stores=function(e){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?U(this._cfg.storesSource,e):e;var r=n._versions,i={},a={};return r.forEach(function(u){U(i,u._cfg.storesSource),a=u._cfg.dbschema={},u._parseStoresSpec(i,a)}),n._dbSchema=a,Jt(n,[n._allTables,n,n.Transaction.prototype]),bt(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],z(a),a),n._storeNames=z(a),this},t.prototype.upgrade=function(e){return this._cfg.contentUpgrade=fn(this._cfg.contentUpgrade||O,e),this},t}();function Ni(t){return tt(zi.prototype,function(n){this.db=t,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function _n(t,e){var n=t._dbNamesDB;return n||(n=t._dbNamesDB=new En(Ct,{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function bn(t){return t&&typeof t.databases=="function"}function ji(t){var e=t.indexedDB,n=t.IDBKeyRange;return bn(e)?Promise.resolve(e.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==Ct})}):_n(e,n).toCollection().primaryKeys()}function Li(t,e){var n=t.indexedDB,r=t.IDBKeyRange;!bn(n)&&e!==Ct&&_n(n,r).put({name:e}).catch(O)}function Vi(t,e){var n=t.indexedDB,r=t.IDBKeyRange;!bn(n)&&e!==Ct&&_n(n,r).delete(e).catch(O)}function tn(t){return ve(function(){return A.letThrough=!0,t()})}function Hi(){var t=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!t||!indexedDB.databases)return Promise.resolve();var e;return new Promise(function(n){var r=function(){return indexedDB.databases().finally(n)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)})}function Ui(t){var e=t._state,n=t._deps.indexedDB;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(function(){return e.dbOpenError?N(e.dbOpenError):t});te&&(e.openCanceller._stackHolder=ke()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;var r=e.openCanceller;function i(){if(e.openCanceller!==r)throw new K.DatabaseClosed("db.open() was cancelled")}var a=e.dbReadyResolve,u=null,o=!1;return k.race([r,(typeof navigator=="undefined"?k.resolve():Hi()).then(function(){return new k(function(s,c){if(i(),!n)throw new K.MissingAPI;var f=t.name,l=e.autoSchema?n.open(f):n.open(f,Math.round(t.verno*10));if(!l)throw new K.MissingAPI;l.onerror=ee(c),l.onblocked=F(t._fireOnBlocked),l.onupgradeneeded=F(function(d){if(u=l.transaction,e.autoSchema&&!t._options.allowEmptyDB){l.onerror=Ye,u.abort(),l.result.close();var _=n.deleteDatabase(f);_.onsuccess=_.onerror=F(function(){c(new K.NoSuchDatabase("Database "+f+" doesnt exist"))})}else{u.onerror=ee(c);var v=d.oldVersion>Math.pow(2,62)?0:d.oldVersion;o=v<1,t._novip.idbdb=l.result,Ii(t,v/10,u,c)}},c),l.onsuccess=F(function(){u=null;var d=t._novip.idbdb=l.result,_=Et(d.objectStoreNames);if(_.length>0)try{var v=d.transaction(ki(_),"readonly");e.autoSchema?Oi(t,d,v):(en(t,t._dbSchema,v),Mi(t,v)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),yn(t,v)}catch{}Le.push(t),d.onversionchange=F(function(h){e.vcFired=!0,t.on("versionchange").fire(h)}),d.onclose=F(function(h){t.on("close").fire(h)}),o&&Li(t._deps,f),s()},c)})})]).then(function(){return i(),e.onReadyBeingFired=[],k.resolve(tn(function(){return t.on.ready.fire(t.vip)})).then(function s(){if(e.onReadyBeingFired.length>0){var c=e.onReadyBeingFired.reduce(fn,O);return e.onReadyBeingFired=[],k.resolve(tn(function(){return c(t.vip)})).then(s)}})}).finally(function(){e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(function(){return t}).catch(function(s){e.dbOpenError=s;try{u&&u.abort()}catch{}return r===e.openCanceller&&t._close(),N(s)}).finally(function(){e.openComplete=!0,a()})}function nn(t){var e=function(u){return t.next(u)},n=function(u){return t.throw(u)},r=a(e),i=a(n);function a(u){return function(o){var s=u(o),c=s.value;return s.done?c:!c||typeof c.then!="function"?V(c)?Promise.all(c).then(r,i):r(c):c.then(r,i)}}return a(e)()}function Wi(t,e,n){var r=arguments.length;if(r<2)throw new K.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var a=Un(i);return[t,a,n]}function dr(t,e,n,r,i){return k.resolve().then(function(){var a=A.transless||A,u=t._createTransaction(e,n,t._dbSchema,r),o={trans:u,transless:a};if(r)u.idbtrans=r.idbtrans;else try{u.create(),t._state.PR1398_maxLoop=3}catch(l){return l.name===ln.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(function(){return dr(t,e,n,null,i)})):N(l)}var s=sn(i);s&&Be();var c,f=k.follow(function(){if(c=i.call(u,u),c)if(s){var l=se.bind(null,null);c.then(l,l)}else typeof c.next=="function"&&typeof c.throw=="function"&&(c=nn(c))},o);return(c&&typeof c.then=="function"?k.resolve(c).then(function(l){return u.active?l:N(new K.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):f.then(function(){return c})).then(function(l){return r&&u._resolve(),u._completion.then(function(){return l})}).catch(function(l){return u._reject(l),N(l)})})}function ot(t,e,n){for(var r=V(t)?t.slice():[t],i=0;i<n;++i)r.push(e);return r}function Yi(t){return I(I({},t),{table:function(e){var n=t.table(e),r=n.schema,i={},a=[];function u(h,y,b){var w=Ve(h),m=i[w]=i[w]||[],g=h==null?0:typeof h=="string"?1:h.length,p=y>0,x=I(I({},b),{isVirtual:p,keyTail:y,keyLength:g,extractKey:qt(h),unique:!p&&b.unique});if(m.push(x),x.isPrimaryKey||a.push(x),g>1){var C=g===2?h[0]:h.slice(0,g-1);u(C,y+1,b)}return m.sort(function(E,S){return E.keyTail-S.keyTail}),x}var o=u(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[o];for(var s=0,c=r.indexes;s<c.length;s++){var f=c[s];u(f.keyPath,0,f)}function l(h){var y=i[Ve(h)];return y&&y[0]}function d(h,y){return{type:h.type===1?2:h.type,lower:ot(h.lower,h.lowerOpen?t.MAX_KEY:t.MIN_KEY,y),lowerOpen:!0,upper:ot(h.upper,h.upperOpen?t.MIN_KEY:t.MAX_KEY,y),upperOpen:!0}}function _(h){var y=h.query.index;return y.isVirtual?I(I({},h),{query:{index:y,range:d(h.query.range,y.keyTail)}}):h}var v=I(I({},n),{schema:I(I({},r),{primaryKey:o,indexes:a,getIndexByKeyPath:l}),count:function(h){return n.count(_(h))},query:function(h){return n.query(_(h))},openCursor:function(h){var y=h.query.index,b=y.keyTail,w=y.isVirtual,m=y.keyLength;if(!w)return n.openCursor(h);function g(p){function x(E){E!=null?p.continue(ot(E,h.reverse?t.MAX_KEY:t.MIN_KEY,b)):h.unique?p.continue(p.key.slice(0,m).concat(h.reverse?t.MIN_KEY:t.MAX_KEY,b)):p.continue()}var C=Object.create(p,{continue:{value:x},continuePrimaryKey:{value:function(E,S){p.continuePrimaryKey(ot(E,t.MAX_KEY,b),S)}},primaryKey:{get:function(){return p.primaryKey}},key:{get:function(){var E=p.key;return m===1?E[0]:E.slice(0,m)}},value:{get:function(){return p.value}}});return C}return n.openCursor(_(h)).then(function(p){return p&&g(p)})}});return v}})}var $i={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:Yi};function wn(t,e,n,r){return n=n||{},r=r||"",z(t).forEach(function(i){if(!Q(e,i))n[r+i]=void 0;else{var a=t[i],u=e[i];if(typeof a=="object"&&typeof u=="object"&&a&&u){var o=Ft(a),s=Ft(u);o!==s?n[r+i]=e[i]:o==="Object"?wn(a,u,n,r+i+"."):a!==u&&(n[r+i]=e[i])}else a!==u&&(n[r+i]=e[i])}}),z(e).forEach(function(i){Q(t,i)||(n[r+i]=e[i])}),n}function Qi(t,e){return e.type==="delete"?e.keys:e.keys||e.values.map(t.extractKey)}var Xi={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(t){return I(I({},t),{table:function(e){var n=t.table(e),r=n.schema.primaryKey,i=I(I({},n),{mutate:function(a){var u=A.trans,o=u.table(e).hook,s=o.deleting,c=o.creating,f=o.updating;switch(a.type){case"add":if(c.fire===O)break;return u._promise("readwrite",function(){return l(a)},!0);case"put":if(c.fire===O&&f.fire===O)break;return u._promise("readwrite",function(){return l(a)},!0);case"delete":if(s.fire===O)break;return u._promise("readwrite",function(){return l(a)},!0);case"deleteRange":if(s.fire===O)break;return u._promise("readwrite",function(){return d(a)},!0)}return n.mutate(a);function l(v){var h=A.trans,y=v.keys||Qi(r,v);if(!y)throw new Error("Keys missing");return v=v.type==="add"||v.type==="put"?I(I({},v),{keys:y}):I({},v),v.type!=="delete"&&(v.values=Ot([],v.values,!0)),v.keys&&(v.keys=Ot([],v.keys,!0)),Gi(n,v,y).then(function(b){var w=y.map(function(m,g){var p=b[g],x={onerror:null,onsuccess:null};if(v.type==="delete")s.fire.call(x,m,p,h);else if(v.type==="add"||p===void 0){var C=c.fire.call(x,m,v.values[g],h);m==null&&C!=null&&(m=C,v.keys[g]=m,r.outbound||q(v.values[g],r.keyPath,m))}else{var E=wn(p,v.values[g]),S=f.fire.call(x,E,m,p,h);if(S){var T=v.values[g];Object.keys(S).forEach(function(R){Q(T,R)?T[R]=S[R]:q(T,R,S[R])})}}return x});return n.mutate(v).then(function(m){for(var g=m.failures,p=m.results,x=m.numFailures,C=m.lastResult,E=0;E<y.length;++E){var S=p?p[E]:y[E],T=w[E];S==null?T.onerror&&T.onerror(g[E]):T.onsuccess&&T.onsuccess(v.type==="put"&&b[E]?v.values[E]:S)}return{failures:g,results:p,numFailures:x,lastResult:C}}).catch(function(m){return w.forEach(function(g){return g.onerror&&g.onerror(m)}),Promise.reject(m)})})}function d(v){return _(v.trans,v.range,1e4)}function _(v,h,y){return n.query({trans:v,values:!1,query:{index:r,range:h},limit:y}).then(function(b){var w=b.result;return l({type:"delete",keys:w,trans:v}).then(function(m){return m.numFailures>0?Promise.reject(m.failures[0]):w.length<y?{failures:[],numFailures:0,lastResult:void 0}:_(v,I(I({},h),{lower:w[w.length-1],lowerOpen:!0}),y)})})}}});return i}})}};function Gi(t,e,n){return e.type==="add"?Promise.resolve([]):t.getMany({trans:e.trans,keys:n,cache:"immutable"})}function vr(t,e,n){try{if(!e||e.keys.length<t.length)return null;for(var r=[],i=0,a=0;i<e.keys.length&&a<t.length;++i)H(e.keys[i],t[a])===0&&(r.push(n?Ge(e.values[i]):e.values[i]),++a);return r.length===t.length?r:null}catch{return null}}var qi={stack:"dbcore",level:-1,create:function(t){return{table:function(e){var n=t.table(e);return I(I({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var i=vr(r.keys,r.trans._cache,r.cache==="clone");return i?k.resolve(i):n.getMany(r).then(function(a){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?Ge(a):a},a})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}},Bt;function xn(t){return!("from"in t)}var re=function(t,e){if(this)U(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0});else{var n=new re;return t&&"d"in t&&U(n,t),n}};Ie(re.prototype,(Bt={add:function(t){return wt(this,t),this},addKey:function(t){return Xe(this,t,t),this},addKeys:function(t){var e=this;return t.forEach(function(n){return Xe(e,n,n)}),this}},Bt[zt]=function(){return rn(this)},Bt));function Xe(t,e,n){var r=H(e,n);if(!isNaN(r)){if(r>0)throw RangeError();if(xn(t))return U(t,{from:e,to:n,d:1});var i=t.l,a=t.r;if(H(n,t.from)<0)return i?Xe(i,e,n):t.l={from:e,to:n,d:1,l:null,r:null},On(t);if(H(e,t.to)>0)return a?Xe(a,e,n):t.r={from:e,to:n,d:1,l:null,r:null},On(t);H(e,t.from)<0&&(t.from=e,t.l=null,t.d=a?a.d+1:1),H(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);var u=!t.r;i&&!t.l&&wt(t,i),a&&u&&wt(t,a)}}function wt(t,e){function n(r,i){var a=i.from,u=i.to,o=i.l,s=i.r;Xe(r,a,u),o&&n(r,o),s&&n(r,s)}xn(e)||n(t,e)}function Ji(t,e){var n=rn(e),r=n.next();if(r.done)return!1;for(var i=r.value,a=rn(t),u=a.next(i.from),o=u.value;!r.done&&!u.done;){if(H(o.from,i.to)<=0&&H(o.to,i.from)>=0)return!0;H(i.from,o.from)<0?i=(r=n.next(o.from)).value:o=(u=a.next(i.from)).value}return!1}function rn(t){var e=xn(t)?null:{s:0,n:t};return{next:function(n){for(var r=arguments.length>0;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&H(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||H(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function On(t){var e,n,r=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((n=t.l)===null||n===void 0?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){var a=i==="r"?"l":"r",u=I({},t),o=t[i];t.from=o.from,t.to=o.to,t[i]=o[i],u[i]=o[a],t[a]=u,u.d=Mn(u)}t.d=Mn(t)}function Mn(t){var e=t.r,n=t.l;return(e?n?Math.max(e.d,n.d):e.d:n?n.d:0)+1}var Zi={stack:"dbcore",level:0,create:function(t){var e=t.schema.name,n=new re(t.MIN_KEY,t.MAX_KEY);return I(I({},t),{table:function(r){var i=t.table(r),a=i.schema,u=a.primaryKey,o=u.extractKey,s=u.outbound,c=I(I({},i),{mutate:function(d){var _=d.trans,v=_.mutatedParts||(_.mutatedParts={}),h=function(C){var E="idb://"+e+"/"+r+"/"+C;return v[E]||(v[E]=new re)},y=h(""),b=h(":dels"),w=d.type,m=d.type==="deleteRange"?[d.range]:d.type==="delete"?[d.keys]:d.values.length<50?[[],d.values]:[],g=m[0],p=m[1],x=d.trans._cache;return i.mutate(d).then(function(C){if(V(g)){w!=="delete"&&(g=C.results),y.addKeys(g);var E=vr(g,x);!E&&w!=="add"&&b.addKeys(g),(E||p)&&ea(h,a,E,p)}else if(g){var S={from:g.lower,to:g.upper};b.add(S),y.add(S)}else y.add(n),b.add(n),a.indexes.forEach(function(T){return h(T.name).add(n)});return C})}}),f=function(d){var _,v,h=d.query,y=h.index,b=h.range;return[y,new re((_=b.lower)!==null&&_!==void 0?_:t.MIN_KEY,(v=b.upper)!==null&&v!==void 0?v:t.MAX_KEY)]},l={get:function(d){return[u,new re(d.key)]},getMany:function(d){return[u,new re().addKeys(d.keys)]},count:f,query:f,openCursor:f};return z(l).forEach(function(d){c[d]=function(_){var v=A.subscr;if(v){var h=function(x){var C="idb://"+e+"/"+r+"/"+x;return v[C]||(v[C]=new re)},y=h(""),b=h(":dels"),w=l[d](_),m=w[0],g=w[1];if(h(m.name||"").add(g),!m.isPrimaryKey)if(d==="count")b.add(n);else{var p=d==="query"&&s&&_.values&&i.query(I(I({},_),{values:!1}));return i[d].apply(this,arguments).then(function(x){if(d==="query"){if(s&&_.values)return p.then(function(T){var R=T.result;return y.addKeys(R),x});var C=_.values?x.result.map(o):x.result;_.values?y.addKeys(C):b.addKeys(C)}else if(d==="openCursor"){var E=x,S=_.values;return E&&Object.create(E,{key:{get:function(){return b.addKey(E.primaryKey),E.key}},primaryKey:{get:function(){var T=E.primaryKey;return b.addKey(T),T}},value:{get:function(){return S&&y.addKey(E.primaryKey),E.value}}})}return x})}}return i[d].apply(this,arguments)}}),c}})}};function ea(t,e,n,r){function i(a){var u=t(a.name||"");function o(c){return c!=null?a.extractKey(c):null}var s=function(c){return a.multiEntry&&V(c)?c.forEach(function(f){return u.addKey(f)}):u.addKey(c)};(n||r).forEach(function(c,f){var l=n&&o(n[f]),d=r&&o(r[f]);H(l,d)!==0&&(l!=null&&s(l),d!=null&&s(d))})}e.indexes.forEach(i)}var En=function(){function t(e,n){var r=this;this._middlewares={},this.verno=0;var i=t.dependencies;this._options=n=I({addons:t.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var a=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var u={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:O,dbReadyPromise:null,cancelOpen:O,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};u.dbReadyPromise=new k(function(o){u.dbReadyResolve=o}),u.openCanceller=new k(function(o,s){u.cancelOpen=s}),this._state=u,this.name=e,this.on=et(this,"populate","blocked","versionchange","close",{ready:[fn,O]}),this.on.ready.subscribe=jn(this.on.ready.subscribe,function(o){return function(s,c){t.vip(function(){var f=r._state;if(f.openComplete)f.dbOpenError||k.resolve().then(s),c&&o(s);else if(f.onReadyBeingFired)f.onReadyBeingFired.push(s),c&&o(s);else{o(s);var l=r;c||o(function d(){l.on.ready.unsubscribe(s),l.on.ready.unsubscribe(d)})}})}}),this.Collection=pi(this),this.Table=li(this),this.Transaction=Ei(this),this.Version=Ni(this),this.WhereClause=wi(this),this.on("versionchange",function(o){o.newVersion>0?console.warn("Another connection wants to upgrade database '"+r.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+r.name+"'. Closing db now to resume the delete request."),r.close()}),this.on("blocked",function(o){!o.newVersion||o.newVersion<o.oldVersion?console.warn("Dexie.delete('"+r.name+"') was blocked"):console.warn("Upgrade '"+r.name+"' blocked by other connection holding version "+o.oldVersion/10)}),this._maxKey=Qe(n.IDBKeyRange),this._createTransaction=function(o,s,c,f){return new r.Transaction(o,s,c,r._options.chromeTransactionDurability,f)},this._fireOnBlocked=function(o){r.on("blocked").fire(o),Le.filter(function(s){return s.name===r.name&&s!==r&&!s._state.vcFired}).map(function(s){return s.on("versionchange").fire(o)})},this.use($i),this.use(Xi),this.use(Zi),this.use(qi),this.vip=Object.create(this,{_vip:{value:!0}}),a.forEach(function(o){return o(r)})}return t.prototype.version=function(e){if(isNaN(e)||e<.1)throw new K.Type("Given version is not a positive number");if(e=Math.round(e*10)/10,this.idbdb||this._state.isBeingOpened)throw new K.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var n=this._versions,r=n.filter(function(i){return i._cfg.version===e})[0];return r||(r=new this.Version(e),n.push(r),n.sort(Di),r.stores({}),this._state.autoSchema=!1,r)},t.prototype._whenReady=function(e){var n=this;return this.idbdb&&(this._state.openComplete||A.letThrough||this._vip)?e():new k(function(r,i){if(n._state.openComplete)return i(new K.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._options.autoOpen){i(new K.DatabaseClosed);return}n.open().catch(O)}n._state.dbReadyPromise.then(r,i)}).then(e)},t.prototype.use=function(e){var n=e.stack,r=e.create,i=e.level,a=e.name;a&&this.unuse({stack:n,name:a});var u=this._middlewares[n]||(this._middlewares[n]=[]);return u.push({stack:n,create:r,level:i==null?10:i,name:a}),u.sort(function(o,s){return o.level-s.level}),this},t.prototype.unuse=function(e){var n=e.stack,r=e.name,i=e.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(a){return i?a.create!==i:r?a.name!==r:!1})),this},t.prototype.open=function(){return Ui(this)},t.prototype._close=function(){var e=this._state,n=Le.indexOf(this);if(n>=0&&Le.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new k(function(r){e.dbReadyResolve=r}),e.openCanceller=new k(function(r,i){e.cancelOpen=i})},t.prototype.close=function(){this._close();var e=this._state;this._options.autoOpen=!1,e.dbOpenError=new K.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)},t.prototype.delete=function(){var e=this,n=arguments.length>0,r=this._state;return new k(function(i,a){var u=function(){e.close();var o=e._deps.indexedDB.deleteDatabase(e.name);o.onsuccess=F(function(){Vi(e._deps,e.name),i()}),o.onerror=ee(a),o.onblocked=e._fireOnBlocked};if(n)throw new K.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(u):u()})},t.prototype.backendDB=function(){return this.idbdb},t.prototype.isOpen=function(){return this.idbdb!==null},t.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},t.prototype.hasFailed=function(){return this._state.dbOpenError!==null},t.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(t.prototype,"tables",{get:function(){var e=this;return z(this._allTables).map(function(n){return e._allTables[n]})},enumerable:!1,configurable:!0}),t.prototype.transaction=function(){var e=Wi.apply(this,arguments);return this._transaction.apply(this,e)},t.prototype._transaction=function(e,n,r){var i=this,a=A.trans;(!a||a.db!==this||e.indexOf("!")!==-1)&&(a=null);var u=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");var o,s;try{if(s=n.map(function(f){var l=f instanceof i.Table?f.name:f;if(typeof l!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return l}),e=="r"||e===Tt)o=Tt;else if(e=="rw"||e==Dt)o=Dt;else throw new K.InvalidArgument("Invalid transaction mode: "+e);if(a){if(a.mode===Tt&&o===Dt)if(u)a=null;else throw new K.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a&&s.forEach(function(f){if(a&&a.storeNames.indexOf(f)===-1)if(u)a=null;else throw new K.SubTransaction("Table "+f+" not included in parent transaction.")}),u&&a&&!a.active&&(a=null)}}catch(f){return a?a._promise(null,function(l,d){d(f)}):N(f)}var c=dr.bind(null,this,o,s,a,r);return a?a._promise(o,c,"lock"):A.trans?Oe(A.transless,function(){return i._whenReady(c)}):this._whenReady(c)},t.prototype.table=function(e){if(!Q(this._allTables,e))throw new K.InvalidTable("Table "+e+" does not exist");return this._allTables[e]},t}(),ta=typeof Symbol!="undefined"&&"observable"in Symbol?Symbol.observable:"@@observable",na=function(){function t(e){this._subscribe=e}return t.prototype.subscribe=function(e,n,r){return this._subscribe(!e||typeof e=="function"?{next:e,error:n,complete:r}:e)},t.prototype[ta]=function(){return this},t}();function pr(t,e){return z(e).forEach(function(n){var r=t[n]||(t[n]=new re);wt(r,e[n])}),t}function ra(t){return new na(function(e){var n=sn(t);function r(_){n&&Be();var v=function(){return ve(t,{subscr:_,trans:null})},h=A.trans?Oe(A.transless,v):v();return n&&h.then(se,se),h}var i=!1,a={},u={},o={get closed(){return i},unsubscribe:function(){i=!0,ye.storagemutated.unsubscribe(l)}};e.start&&e.start(o);var s=!1,c=!1;function f(){return z(u).some(function(_){return a[_]&&Ji(a[_],u[_])})}var l=function(_){pr(a,_),f()&&d()},d=function(){if(!(s||i)){a={};var _={},v=r(_);c||(ye($e,l),c=!0),s=!0,Promise.resolve(v).then(function(h){s=!1,!i&&(f()?d():(a={},u=_,e.next&&e.next(h)))},function(h){s=!1,e.error&&e.error(h),o.unsubscribe()})}};return d(),o})}var an;try{an={indexedDB:M.indexedDB||M.mozIndexedDB||M.webkitIndexedDB||M.msIndexedDB,IDBKeyRange:M.IDBKeyRange||M.webkitIDBKeyRange}}catch{an={indexedDB:null,IDBKeyRange:null}}var me=En;Ie(me,I(I({},kt),{delete:function(t){var e=new me(t,{addons:[]});return e.delete()},exists:function(t){return new me(t,{addons:[]}).open().then(function(e){return e.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(t){try{return ji(me.dependencies).then(t)}catch{return N(new K.MissingAPI)}},defineClass:function(){function t(e){U(this,e)}return t},ignoreTransaction:function(t){return A.trans?Oe(A.transless,t):t()},vip:tn,async:function(t){return function(){try{var e=nn(t.apply(this,arguments));return!e||typeof e.then!="function"?k.resolve(e):e}catch(n){return N(n)}}},spawn:function(t,e,n){try{var r=nn(t.apply(n,e||[]));return!r||typeof r.then!="function"?k.resolve(r):r}catch(i){return N(i)}},currentTransaction:{get:function(){return A.trans||null}},waitFor:function(t,e){var n=k.resolve(typeof t=="function"?me.ignoreTransaction(t):t).timeout(e||6e4);return A.trans?A.trans.waitFor(n):n},Promise:k,debug:{get:function(){return te},set:function(t){Yn(t,t==="dexie"?function(){return!0}:ur)}},derive:Pe,extend:U,props:Ie,override:jn,Events:et,on:ye,liveQuery:ra,extendObservabilitySet:pr,getByKeyPath:ue,setByKeyPath:q,delByKeyPath:Or,shallowClone:Hn,deepClone:Ge,getObjectDiff:wn,cmp:H,asap:Ln,minKey:Xt,addons:[],connections:Le,errnames:ln,dependencies:an,semVer:Tn,version:Tn.split(".").map(function(t){return parseInt(t)}).reduce(function(t,e,n){return t+e/Math.pow(10,n*2)})}));me.maxKey=Qe(me.dependencies.IDBKeyRange);typeof dispatchEvent!="undefined"&&typeof addEventListener!="undefined"&&(ye($e,function(t){if(!ae){var e;At?(e=document.createEvent("CustomEvent"),e.initCustomEvent(de,!0,!0,t)):e=new CustomEvent(de,{detail:t}),ae=!0,dispatchEvent(e),ae=!1}}),addEventListener(de,function(t){var e=t.detail;ae||xt(e)}));function xt(t){var e=ae;try{ae=!0,ye.storagemutated.fire(t)}finally{ae=e}}var ae=!1;if(typeof BroadcastChannel!="undefined"){var Fn=new BroadcastChannel(de);ye($e,function(t){ae||Fn.postMessage(t)}),Fn.onmessage=function(t){t.data&&xt(t.data)}}else if(typeof self!="undefined"&&typeof navigator!="undefined"){ye($e,function(t){try{ae||(typeof localStorage!="undefined"&&localStorage.setItem(de,JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&Ot([],self.clients.matchAll({includeUncontrolled:!0}),!0).forEach(function(e){return e.postMessage({type:de,changedParts:t})}))}catch{}}),addEventListener("storage",function(t){if(t.key===de){var e=JSON.parse(t.newValue);e&&xt(e.changedParts)}});var zn=self.document&&navigator.serviceWorker;zn&&zn.addEventListener("message",ia)}function ia(t){var e=t.data;e&&e.type===de&&xt(e.changedParts)}k.rejectionMapper=Ur;Yn(te,ur);const Ke=new En("todo-db");Ke.version(1).stores({tasks:"++id, taskId"});const aa={},ua=t=>(mr("data-v-2d7a3f06"),t=t(),gr(),t),oa={xmlns:"http://www.w3.org/2000/svg",width:"30",height:"20",fill:"currentColor"},sa=ua(()=>_e("path",{d:"M11 2.253a1 1 0 1 0-2 0h2zm-2 13a1 1 0 1 0 2 0H9zm.447-12.167a1 1 0 1 0 1.107-1.666L9.447 3.086zM1 2.253L.447 1.42A1 1 0 0 0 0 2.253h1zm0 13H0a1 1 0 0 0 1.553.833L1 15.253zm8.447.833a1 1 0 1 0 1.107-1.666l-1.107 1.666zm0-14.666a1 1 0 1 0 1.107 1.666L9.447 1.42zM19 2.253h1a1 1 0 0 0-.447-.833L19 2.253zm0 13l-.553.833A1 1 0 0 0 20 15.253h-1zm-9.553-.833a1 1 0 1 0 1.107 1.666L9.447 14.42zM9 2.253v13h2v-13H9zm1.553-.833C9.203.523 7.42 0 5.5 0v2c1.572 0 2.961.431 3.947 1.086l1.107-1.666zM5.5 0C3.58 0 1.797.523.447 1.42l1.107 1.666C2.539 2.431 3.928 2 5.5 2V0zM0 2.253v13h2v-13H0zm1.553 13.833C2.539 15.431 3.928 15 5.5 15v-2c-1.92 0-3.703.523-5.053 1.42l1.107 1.666zM5.5 15c1.572 0 2.961.431 3.947 1.086l1.107-1.666C9.203 13.523 7.42 13 5.5 13v2zm5.053-11.914C11.539 2.431 12.928 2 14.5 2V0c-1.92 0-3.703.523-5.053 1.42l1.107 1.666zM14.5 2c1.573 0 2.961.431 3.947 1.086l1.107-1.666C18.203.523 16.421 0 14.5 0v2zm3.5.253v13h2v-13h-2zm1.553 12.167C18.203 13.523 16.421 13 14.5 13v2c1.573 0 2.961.431 3.947 1.086l1.107-1.666zM14.5 13c-1.92 0-3.703.523-5.053 1.42l1.107 1.666C11.539 15.431 12.928 15 14.5 15v-2z"},null,-1)),ca=[sa];function la(t,e){return Te(),Ne("svg",oa,ca)}var fa=un(aa,[["render",la],["__scopeId","data-v-2d7a3f06"]]);class ha{constructor(){this.id=0}async addTask(e,n){if(e.value){let r={id:this.id++,text:e.value,done:!1};n.value.push(r),e.value="",await Ke.tasks.add({taskId:r.id,text:r.text,done:r.done})}}async completeTask(e){e.done=!e.done,await Ke.tasks.where("taskId").equals(e.id).modify({done:e.done})}async removeTask(e,n){n.value=n.value.filter(r=>r.id!=e.id),await Ke.tasks.where("taskId").equals(e.id).delete()}async retrieveTasks(e){let n=await Ke.tasks.toArray();n.length?(e.value=[],n.forEach(r=>{e.value.push({id:r.taskId,text:r.text,done:r.done})})):(e.value=[{id:this.id++,text:"Take out the trash",done:!1},{id:this.id++,text:"Do the dishes",done:!1}],e.value.forEach(async r=>{await Ke.tasks.add({taskId:r.id,text:r.text,done:r.done})}))}}const da={class:"todo-item"},va={props:["todo"],setup(t){const e=t;return(n,r)=>(Te(),Ne("li",da,[_e("button",{onClick:r[0]||(r[0]=i=>n.$emit("complete-task"))},"\u2705"),_e("span",{class:br({complete:e.todo.done})},_r(e.todo.text),3),_e("button",{onClick:r[1]||(r[1]=i=>n.$emit("remove-task")),style:{"margin-left":"auto"}},"\u274C")]))}};var pa=un(va,[["__scopeId","data-v-13fe782e"]]);const ya=Tr(" My To-do's"),ma={key:0,class:"small-text"},ga={setup(t){const e=new ha,n=kn([]),r=kn(null),i={thisTodo:r,todos:n};return wr(async()=>{e.retrieveTasks(i.todos)}),(a,u)=>(Te(),Ne("section",null,[_e("h1",null,[xr(fa),ya]),n.value.length?Er("",!0):(Te(),Ne("p",ma," (Type in the text box below, and press enter to add the task) ")),kr(_e("input",{"onUpdate:modelValue":u[0]||(u[0]=o=>r.value=o),onKeyup:u[1]||(u[1]=Cr(o=>St(e).addTask(i.thisTodo,i.todos),["enter"])),type:"text",id:"task-input",placeholder:"I have to..."},null,544),[[Ar,r.value]]),_e("ul",null,[(Te(!0),Ne(Sr,null,Kr(n.value,o=>(Te(),Dr(pa,{todo:o,key:o.id,onCompleteTask:s=>St(e).completeTask(o),onRemoveTask:s=>St(e).removeTask(o,i.todos)},null,8,["todo","onCompleteTask","onRemoveTask"]))),128))])]))}};var wa=un(ga,[["__scopeId","data-v-cde9e914"]]);export{wa as default};
